var cov_2p9s8q9vq6=function(){var path="/Users/Tyler/ganache-fork/ganache-core/lib/subproviders/requestfunnel.js";var hash="bd593c81e72d042b192169f29003fb84be4afdc3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/Tyler/ganache-fork/ganache-core/lib/subproviders/requestfunnel.js",statementMap:{"0":{start:{line:1,column:18},end:{line:1,column:77}},"1":{start:{line:2,column:15},end:{line:2,column:39}},"2":{start:{line:4,column:0},end:{line:4,column:37}},"3":{start:{line:6,column:0},end:{line:6,column:31}},"4":{start:{line:13,column:2},end:{line:25,column:4}},"5":{start:{line:26,column:2},end:{line:26,column:18}},"6":{start:{line:27,column:2},end:{line:27,column:25}},"7":{start:{line:30,column:0},end:{line:40,column:2}},"8":{start:{line:31,column:2},end:{line:33,column:3}},"9":{start:{line:32,column:4},end:{line:32,column:18}},"10":{start:{line:35,column:2},end:{line:35,column:35}},"11":{start:{line:37,column:2},end:{line:39,column:3}},"12":{start:{line:38,column:4},end:{line:38,column:23}},"13":{start:{line:42,column:0},end:{line:62,column:2}},"14":{start:{line:43,column:13},end:{line:43,column:17}},"15":{start:{line:45,column:2},end:{line:48,column:3}},"16":{start:{line:46,column:4},end:{line:46,column:27}},"17":{start:{line:47,column:4},end:{line:47,column:11}},"18":{start:{line:50,column:2},end:{line:50,column:24}},"19":{start:{line:52,column:13},end:{line:52,column:31}},"20":{start:{line:53,column:13},end:{line:53,column:20}},"21":{start:{line:55,column:2},end:{line:61,column:5}},"22":{start:{line:56,column:4},end:{line:58,column:5}},"23":{start:{line:57,column:6},end:{line:57,column:23}},"24":{start:{line:59,column:4},end:{line:59,column:9}},"25":{start:{line:60,column:4},end:{line:60,column:23}}},fnMap:{"0":{name:"RequestFunnel",decl:{start:{line:11,column:9},end:{line:11,column:22}},loc:{start:{line:11,column:25},end:{line:28,column:1}},line:11},"1":{name:"(anonymous_1)",decl:{start:{line:30,column:40},end:{line:30,column:41}},loc:{start:{line:30,column:69},end:{line:40,column:1}},line:30},"2":{name:"(anonymous_2)",decl:{start:{line:42,column:38},end:{line:42,column:39}},loc:{start:{line:42,column:49},end:{line:62,column:1}},line:42},"3":{name:"(anonymous_3)",decl:{start:{line:55,column:7},end:{line:55,column:8}},loc:{start:{line:55,column:36},end:{line:61,column:3}},line:55}},branchMap:{"0":{loc:{start:{line:31,column:2},end:{line:33,column:3}},type:"if",locations:[{start:{line:31,column:2},end:{line:33,column:3}},{start:{line:31,column:2},end:{line:33,column:3}}],line:31},"1":{loc:{start:{line:31,column:6},end:{line:31,column:72}},type:"binary-expr",locations:[{start:{line:31,column:6},end:{line:31,column:31}},{start:{line:31,column:35},end:{line:31,column:72}}],line:31},"2":{loc:{start:{line:37,column:2},end:{line:39,column:3}},type:"if",locations:[{start:{line:37,column:2},end:{line:39,column:3}},{start:{line:37,column:2},end:{line:39,column:3}}],line:37},"3":{loc:{start:{line:45,column:2},end:{line:48,column:3}},type:"if",locations:[{start:{line:45,column:2},end:{line:48,column:3}},{start:{line:45,column:2},end:{line:48,column:3}}],line:45},"4":{loc:{start:{line:56,column:4},end:{line:58,column:5}},type:"if",locations:[{start:{line:56,column:4},end:{line:58,column:5}},{start:{line:56,column:4},end:{line:58,column:5}}],line:56}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"bd593c81e72d042b192169f29003fb84be4afdc3"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();var Subprovider=(cov_2p9s8q9vq6.s[0]++,require("web3-provider-engine/subproviders/subprovider.js"));var inherits=(cov_2p9s8q9vq6.s[1]++,require("util").inherits);cov_2p9s8q9vq6.s[2]++;inherits(RequestFunnel,Subprovider);cov_2p9s8q9vq6.s[3]++;module.exports=RequestFunnel;// See if any payloads for the specified methods are marked as external.
// If they are external, and match the method list, process them one at
// a time.
function RequestFunnel(){cov_2p9s8q9vq6.f[0]++;cov_2p9s8q9vq6.s[4]++;// We use an object here for O(1) lookups (speed).
this.methods={eth_call:true,eth_getStorageAt:true,eth_sendTransaction:true,eth_sendRawTransaction:true,// Ensure block filter and filter changes are process one at a time
// as well so filter requests that come in after a transaction get
// processed once that transaction has finished processing.
eth_newBlockFilter:true,eth_getFilterChanges:true,eth_getFilterLogs:true};cov_2p9s8q9vq6.s[5]++;this.queue=[];cov_2p9s8q9vq6.s[6]++;this.isWorking=false;}cov_2p9s8q9vq6.s[7]++;RequestFunnel.prototype.handleRequest=function(payload,next,end){cov_2p9s8q9vq6.f[1]++;cov_2p9s8q9vq6.s[8]++;if((cov_2p9s8q9vq6.b[1][0]++,payload.external!==true)||(cov_2p9s8q9vq6.b[1][1]++,this.methods[payload.method]!==true)){cov_2p9s8q9vq6.b[0][0]++;cov_2p9s8q9vq6.s[9]++;return next();}else{cov_2p9s8q9vq6.b[0][1]++;}cov_2p9s8q9vq6.s[10]++;this.queue.push([payload,next]);cov_2p9s8q9vq6.s[11]++;if(this.isWorking===false){cov_2p9s8q9vq6.b[2][0]++;cov_2p9s8q9vq6.s[12]++;this.processNext();}else{cov_2p9s8q9vq6.b[2][1]++;}};cov_2p9s8q9vq6.s[13]++;RequestFunnel.prototype.processNext=function(){cov_2p9s8q9vq6.f[2]++;var self=(cov_2p9s8q9vq6.s[14]++,this);cov_2p9s8q9vq6.s[15]++;if(this.queue.length===0){cov_2p9s8q9vq6.b[3][0]++;cov_2p9s8q9vq6.s[16]++;this.isWorking=false;cov_2p9s8q9vq6.s[17]++;return;}else{cov_2p9s8q9vq6.b[3][1]++;}cov_2p9s8q9vq6.s[18]++;this.isWorking=true;var item=(cov_2p9s8q9vq6.s[19]++,this.queue.shift());var next=(cov_2p9s8q9vq6.s[20]++,item[1]);cov_2p9s8q9vq6.s[21]++;next(function(error,request,cb){cov_2p9s8q9vq6.f[3]++;cov_2p9s8q9vq6.s[22]++;if(error){cov_2p9s8q9vq6.b[4][0]++;cov_2p9s8q9vq6.s[23]++;return cb(error);}else{cov_2p9s8q9vq6.b[4][1]++;}cov_2p9s8q9vq6.s[24]++;cb();cov_2p9s8q9vq6.s[25]++;self.processNext();});};