var cov_m7r381lqh=function(){var path="/Users/Tyler/ganache-fork/ganache-core/lib/block_tracker.js";var hash="f4c98950a7557d232ba3a3a0f81fef8c9144ca37";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/Tyler/ganache-fork/ganache-core/lib/block_tracker.js",statementMap:{"0":{start:{line:4,column:21},end:{line:4,column:38}},"1":{start:{line:5,column:18},end:{line:5,column:49}},"2":{start:{line:8,column:2},end:{line:8,column:20}},"3":{start:{line:9,column:2},end:{line:9,column:27}},"4":{start:{line:10,column:2},end:{line:12,column:3}},"5":{start:{line:11,column:4},end:{line:11,column:66}},"6":{start:{line:13,column:2},end:{line:15,column:3}},"7":{start:{line:14,column:4},end:{line:14,column:76}},"8":{start:{line:16,column:2},end:{line:16,column:37}},"9":{start:{line:17,column:2},end:{line:17,column:37}},"10":{start:{line:18,column:2},end:{line:18,column:35}},"11":{start:{line:19,column:2},end:{line:19,column:59}},"12":{start:{line:20,column:2},end:{line:20,column:61}},"13":{start:{line:21,column:2},end:{line:21,column:59}},"14":{start:{line:24,column:0},end:{line:24,column:70}},"15":{start:{line:25,column:0},end:{line:25,column:64}},"16":{start:{line:27,column:0},end:{line:29,column:2}},"17":{start:{line:28,column:2},end:{line:28,column:28}},"18":{start:{line:31,column:0},end:{line:33,column:2}},"19":{start:{line:32,column:2},end:{line:32,column:28}},"20":{start:{line:35,column:0},end:{line:43,column:2}},"21":{start:{line:36,column:15},end:{line:36,column:19}},"22":{start:{line:38,column:2},end:{line:40,column:3}},"23":{start:{line:39,column:4},end:{line:39,column:30}},"24":{start:{line:42,column:2},end:{line:42,column:94}},"25":{start:{line:42,column:34},end:{line:42,column:61}},"26":{start:{line:42,column:74},end:{line:42,column:92}},"27":{start:{line:45,column:0},end:{line:48,column:2}},"28":{start:{line:46,column:2},end:{line:46,column:54}},"29":{start:{line:47,column:2},end:{line:47,column:27}},"30":{start:{line:50,column:0},end:{line:53,column:2}},"31":{start:{line:51,column:2},end:{line:51,column:26}},"32":{start:{line:52,column:2},end:{line:52,column:66}},"33":{start:{line:59,column:0},end:{line:69,column:2}},"34":{start:{line:60,column:14},end:{line:60,column:48}},"35":{start:{line:61,column:2},end:{line:63,column:3}},"36":{start:{line:62,column:4},end:{line:62,column:11}},"37":{start:{line:64,column:19},end:{line:64,column:37}},"38":{start:{line:65,column:2},end:{line:65,column:29}},"39":{start:{line:66,column:2},end:{line:66,column:29}},"40":{start:{line:67,column:2},end:{line:67,column:41}},"41":{start:{line:68,column:2},end:{line:68,column:28}},"42":{start:{line:71,column:0},end:{line:71,column:37}}},fnMap:{"0":{name:"GanacheBlockTracker",decl:{start:{line:7,column:9},end:{line:7,column:28}},loc:{start:{line:7,column:35},end:{line:22,column:1}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:27,column:49},end:{line:27,column:50}},loc:{start:{line:27,column:60},end:{line:29,column:1}},line:27},"2":{name:"(anonymous_2)",decl:{start:{line:31,column:48},end:{line:31,column:49}},loc:{start:{line:31,column:59},end:{line:33,column:1}},line:31},"3":{name:"(anonymous_3)",decl:{start:{line:35,column:50},end:{line:35,column:51}},loc:{start:{line:35,column:61},end:{line:43,column:1}},line:35},"4":{name:"(anonymous_4)",decl:{start:{line:42,column:21},end:{line:42,column:22}},loc:{start:{line:42,column:34},end:{line:42,column:61}},line:42},"5":{name:"(anonymous_5)",decl:{start:{line:42,column:68},end:{line:42,column:69}},loc:{start:{line:42,column:74},end:{line:42,column:92}},line:42},"6":{name:"(anonymous_6)",decl:{start:{line:45,column:38},end:{line:45,column:39}},loc:{start:{line:45,column:58},end:{line:48,column:1}},line:45},"7":{name:"(anonymous_7)",decl:{start:{line:50,column:37},end:{line:50,column:38}},loc:{start:{line:50,column:48},end:{line:53,column:1}},line:50},"8":{name:"(anonymous_8)",decl:{start:{line:59,column:49},end:{line:59,column:50}},loc:{start:{line:59,column:68},end:{line:69,column:1}},line:59}},branchMap:{"0":{loc:{start:{line:8,column:9},end:{line:8,column:19}},type:"binary-expr",locations:[{start:{line:8,column:9},end:{line:8,column:13}},{start:{line:8,column:17},end:{line:8,column:19}}],line:8},"1":{loc:{start:{line:10,column:2},end:{line:12,column:3}},type:"if",locations:[{start:{line:10,column:2},end:{line:12,column:3}},{start:{line:10,column:2},end:{line:12,column:3}}],line:10},"2":{loc:{start:{line:13,column:2},end:{line:15,column:3}},type:"if",locations:[{start:{line:13,column:2},end:{line:15,column:3}},{start:{line:13,column:2},end:{line:15,column:3}}],line:13},"3":{loc:{start:{line:38,column:2},end:{line:40,column:3}},type:"if",locations:[{start:{line:38,column:2},end:{line:40,column:3}},{start:{line:38,column:2},end:{line:40,column:3}}],line:38},"4":{loc:{start:{line:45,column:47},end:{line:45,column:56}},type:"default-arg",locations:[{start:{line:45,column:54},end:{line:45,column:56}}],line:45},"5":{loc:{start:{line:61,column:2},end:{line:63,column:3}},type:"if",locations:[{start:{line:61,column:2},end:{line:63,column:3}},{start:{line:61,column:2},end:{line:63,column:3}}],line:61},"6":{loc:{start:{line:61,column:6},end:{line:61,column:66}},type:"binary-expr",locations:[{start:{line:61,column:6},end:{line:61,column:24}},{start:{line:61,column:28},end:{line:61,column:66}}],line:61}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0],"5":[0,0],"6":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184",hash:"f4c98950a7557d232ba3a3a0f81fef8c9144ca37"};var coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}return coverage[path]=coverageData;}();// this replaces `eth-block-tracker` in the provider-engine, as that block tracker is meant to work with
// an external provider instance
const EventEmitter=(cov_m7r381lqh.s[0]++,require("events"));var blockHelper=(cov_m7r381lqh.s[1]++,require("./utils/block_helper"));function GanacheBlockTracker(opts){cov_m7r381lqh.f[0]++;cov_m7r381lqh.s[2]++;opts=(cov_m7r381lqh.b[0][0]++,opts)||(cov_m7r381lqh.b[0][1]++,{});cov_m7r381lqh.s[3]++;EventEmitter.apply(this);cov_m7r381lqh.s[4]++;if(!opts.blockchain){cov_m7r381lqh.b[1][0]++;cov_m7r381lqh.s[5]++;throw new Error("RpcBlockTracker - no blockchain specified.");}else{cov_m7r381lqh.b[1][1]++;}cov_m7r381lqh.s[6]++;if(!opts.blockchain.on){cov_m7r381lqh.b[2][0]++;cov_m7r381lqh.s[7]++;throw new Error("RpcBlockTracker - blockchain is not an EventEmitter.");}else{cov_m7r381lqh.b[2][1]++;}cov_m7r381lqh.s[8]++;this._blockchain=opts.blockchain;cov_m7r381lqh.s[9]++;this.start=this.start.bind(this);cov_m7r381lqh.s[10]++;this.stop=this.stop.bind(this);cov_m7r381lqh.s[11]++;this.getTrackingBlock=this.getTrackingBlock.bind(this);cov_m7r381lqh.s[12]++;this.awaitCurrentBlock=this.awaitCurrentBlock.bind(this);cov_m7r381lqh.s[13]++;this._setCurrentBlock=this._setCurrentBlock.bind(this);}cov_m7r381lqh.s[14]++;GanacheBlockTracker.prototype=Object.create(EventEmitter.prototype);cov_m7r381lqh.s[15]++;GanacheBlockTracker.prototype.constructor=GanacheBlockTracker;cov_m7r381lqh.s[16]++;GanacheBlockTracker.prototype.getTrackingBlock=function(){cov_m7r381lqh.f[1]++;cov_m7r381lqh.s[17]++;return this._currentBlock;};cov_m7r381lqh.s[18]++;GanacheBlockTracker.prototype.getCurrentBlock=function(){cov_m7r381lqh.f[2]++;cov_m7r381lqh.s[19]++;return this._currentBlock;};cov_m7r381lqh.s[20]++;GanacheBlockTracker.prototype.awaitCurrentBlock=function(){cov_m7r381lqh.f[3]++;const self=(cov_m7r381lqh.s[21]++,this);// return if available
cov_m7r381lqh.s[22]++;if(this._currentBlock){cov_m7r381lqh.b[3][0]++;cov_m7r381lqh.s[23]++;return this._currentBlock;}else{cov_m7r381lqh.b[3][1]++;}// wait for "sync" event
cov_m7r381lqh.s[24]++;return new Promise(resolve=>{cov_m7r381lqh.f[4]++;cov_m7r381lqh.s[25]++;return this.once("block",resolve);}).then(()=>{cov_m7r381lqh.f[5]++;cov_m7r381lqh.s[26]++;return self._currentBlock;});};cov_m7r381lqh.s[27]++;GanacheBlockTracker.prototype.start=function(opts=(cov_m7r381lqh.b[4][0]++,{})){cov_m7r381lqh.f[6]++;cov_m7r381lqh.s[28]++;this._blockchain.on("block",this._setCurrentBlock);cov_m7r381lqh.s[29]++;return Promise.resolve();};cov_m7r381lqh.s[30]++;GanacheBlockTracker.prototype.stop=function(){cov_m7r381lqh.f[7]++;cov_m7r381lqh.s[31]++;this._isRunning=false;cov_m7r381lqh.s[32]++;this._blockchain.removeListener("block",this._setCurrentBlock);};//
// private
//
cov_m7r381lqh.s[33]++;GanacheBlockTracker.prototype._setCurrentBlock=function(newBlock){cov_m7r381lqh.f[8]++;let block=(cov_m7r381lqh.s[34]++,blockHelper.toJSON(newBlock,true));cov_m7r381lqh.s[35]++;if((cov_m7r381lqh.b[6][0]++,this._currentBlock)&&(cov_m7r381lqh.b[6][1]++,this._currentBlock.hash===block.hash)){cov_m7r381lqh.b[5][0]++;cov_m7r381lqh.s[36]++;return;}else{cov_m7r381lqh.b[5][1]++;}const oldBlock=(cov_m7r381lqh.s[37]++,this._currentBlock);cov_m7r381lqh.s[38]++;this._currentBlock=block;cov_m7r381lqh.s[39]++;this.emit("latest",block);cov_m7r381lqh.s[40]++;this.emit("sync",{block,oldBlock});cov_m7r381lqh.s[41]++;this.emit("block",block);};cov_m7r381lqh.s[42]++;module.exports=GanacheBlockTracker;